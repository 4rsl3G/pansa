<%
  const t = title || {};
  const enc = (v) => encodeURIComponent((v ?? "").toString());
%>

<section class="wrap">
  <div class="heroWrap" data-aos="fade-up">
    <div class="heroBg"><img src="<%= t.cover || '' %>" class="heroBgImg" alt=""></div>
    <div class="heroContent">
      <div class="chip"><i class="ri-movie-2-line"></i> Title</div>
      <h1 class="heroTitle"><%= t.name || ("Title " + code) %></h1>
      <p class="heroDesc line-clamp-4"><%= t.summary || "No summary." %></p>

      <div class="heroTags">
        <% (t.tags || []).slice(0,5).forEach(tag => { %><span class="tagPill"><%= tag %></span><% }) %>
      </div>

      <div class="heroBtns">
        <a class="btnPrimary" href="/watch/<%= code %>/1?lang=<%= lang %>&cover=<%= enc(t.cover||'') %>&name=<%= enc(t.name||'') %>">
          <i class="ri-play-fill"></i> Play EP 1
        </a>
        <a class="btnGhost" href="/?lang=<%= lang %>"><i class="ri-home-5-line"></i> Home</a>
      </div>
    </div>
  </div>
</section>

<section class="wrap pb-14">
  <div class="rowHead rowHeadTight">
    <h2 class="rowTitle">Episodes</h2>
    <div class="rowSub"><%= (episodes || []).length %> eps</div>
  </div>

  <div class="epGrid mt-4">
    <% (episodes || []).slice(0, 80).forEach(e => { %>
      <a class="epBtn <%= e.locked ? 'is-locked' : '' %>"
         href="/watch/<%= code %>/<%= e.episode %>?lang=<%= lang %>&cover=<%= enc(t.cover||'') %>&name=<%= enc(t.name||'') %>">
        <span>EP <%= e.episode %></span>
        <% if (e.locked) { %><i class="ri-lock-2-line"></i><% } else { %><i class="ri-play-mini-fill"></i><% } %>
      </a>
    <% }) %>
  </div>
</section>
